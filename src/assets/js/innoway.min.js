!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("innoway",[],e):"object"==typeof exports?exports.innoway=e():t.innoway=e()}(this,function(){return function(t){function e(o){if(a[o])return a[o].exports;var n=a[o]={exports:{},id:o,loaded:!1};return t[o].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var a={};return e.m=t,e.c=a,e.p="",e(0)}([function(t,e,a){t.exports=a(9)},function(t,e){"use strict";e.ServerConfig={host:"https://innoway-server.mitek.vn",filesPath:"/uploads/",apiPath:"/apis/v1/",FBAPI:"893757327425340",GoogleAPI:"235416124042-2papc83kbjf14g3m9on0cal3bmihdqm9.apps.googleusercontent.com"},e.APIPath=e.ServerConfig.host+e.ServerConfig.apiPath},function(t,e,a){"use strict";var o=a(1);e.CustomerConfig={authTokenStorage:"innoway.Customer.auth.token",cardsStorage:"innoway.Customer.cards",loginUrl:o.APIPath+"CustomerLogin",signUpUrl:o.APIPath+"Register",updateCustomerUrl:o.APIPath+"EditCustomer",getBillsUrl:o.APIPath+"GetListBillFromCustomer",getBillUrl:o.APIPath+"GetBill",getAllProductsUrl:o.APIPath+"GetAllProduct",sendBillUrl:o.APIPath+"SendBill",addFeedbackUrl:o.APIPath+"AddFeedback",getPromotionsUrl:o.APIPath+"Promotions",getCustomerUrl:o.APIPath+"GetCustomer",getBlogsUrl:o.ServerConfig.host+"/blog/wp-json/posts"}},function(t,e,a){"use strict";var o=a(1);e.EmployeeConfig={GetAllCategoryUrl:o.APIPath+"GetAllCategory"}},function(t,e,a){"use strict";var o=a(1);e.FBConfig=function(){!function(t,e,a){var o,n=t.getElementsByTagName(e)[0];t.getElementById(a)||(o=t.createElement(e),o.id=a,o.src="//connect.facebook.com/en_US/messenger.Extensions.js",n.parentNode.insertBefore(o,n))}(document,"script","Messenger");var t=document,e="script",a="facebook-jssdk";window.fbAsyncInit=function(){FB.init({appId:o.ServerConfig.FBAPI,xfbml:!0,version:"v2.9"}),FB.AppEvents.logPageView()};var n,s=t.getElementsByTagName(e)[0];t.getElementById(a)||(n=t.createElement(e),n.id=a,n.src="//connect.facebook.net/en_US/sdk.js",s.parentNode.insertBefore(n,s))}},function(t,e,a){"use strict";var o=a(1);e.GoogleConfig=function(){var t=document,e="script",a="google-jssdk",n=t.getElementsByTagName("head")[0],s=t.createElement("meta");s.name="google-signin-client_id",s.content=o.ServerConfig.GoogleAPI,n.parentNode.insertBefore(s,n);var r,i=t.getElementsByTagName(e)[0];t.getElementById(a)||(r=t.createElement(e),r.id=a,r.src="https://apis.google.com/js/api.js",r.async=!0,r.onload=function(){gapi.load("auth2",function(){gapi.auth2.init()})},i.parentNode.insertBefore(r,i))}},function(t,e){"use strict";e.CustomerEvents={AuthStateChange:"AuthStateChange",CustomerEdited:"CustomerEdited",CardsChange:"CardsChange"},e.BillStatus={NOT_DELIVERING:"Đang điều phối",WAITING:"Đã điều phối",DELIVERING:"Đang giao",PAYED:"Đã thanh toán",DELETED:"Đã huỷ",UNKNOW:"Không xác định"}},function(t,e,a){"use strict";var o=a(2),n=a(1),s=a(6),r=a(4),i=a(5);r.FBConfig(),i.GoogleConfig();var u=function(){function t(e){void 0===e&&(e=null),this.authenticated=!1,this instanceof t&&(null==e&&(e=localStorage.getItem(o.CustomerConfig.authTokenStorage)),null!=e&&this.loginWithToken(e))}return t.prototype.requiedAuthenticate=function(t){return void 0===t&&(t=function(){}),this.authenticated||t("PERMISSION ERROR","You don't have permission to access"),this.authenticated},t.prototype.login=function(t,e,a,n){var r=this;void 0===a&&(a=function(){}),void 0===n&&(n="");var i={Phone:t,Password:e};n&&(i.FacebookSenderId=n),$.ajax({type:"POST",url:o.CustomerConfig.loginUrl,dataType:"json",data:i}).done(function(t){200===t.StatusCode?(r.user=t.Data,r._token=t.Data.Token,r.authenticated=!0,$(r).trigger(s.CustomerEvents.AuthStateChange,r.authenticated),localStorage.setItem(o.CustomerConfig.authTokenStorage,t.Data.Token),a(null,t.Data)):(r.authenticated=!1,$(r).trigger(s.CustomerEvents.AuthStateChange,r.authenticated),a(t.StatusCode,t.StatusMessage))}).fail(function(t,e,o){r.authenticated=!1,$(r).trigger(s.CustomerEvents.AuthStateChange,r.authenticated),a(e,o)})},t.prototype.loginWithToken=function(t,e){var a=this;void 0===e&&(e=function(){}),$.ajax({type:"POST",url:o.CustomerConfig.getCustomerUrl,dataType:"json",headers:{token:t}}).done(function(t){200===t.StatusCode?(a.user=t.Data,a._token=t.Data.Token,a.authenticated=!0,$(a).trigger(s.CustomerEvents.AuthStateChange,a.authenticated),localStorage.setItem(o.CustomerConfig.authTokenStorage,t.Data.Token),e(null,t.Data)):(a.authenticated=!1,$(a).trigger(s.CustomerEvents.AuthStateChange,a.authenticated),e(t.StatusCode,t.StatusMessage))}).fail(function(t,o,n){a.authenticated=!1,$(a).trigger(s.CustomerEvents.AuthStateChange,a.authenticated),e(o,n)})},Object.defineProperty(t.prototype,"googleProfile",{get:function(){return this._googleProfile},enumerable:!0,configurable:!0}),t.prototype.loginWithGoogle=function(t,e){void 0===t&&(t=function(){}),void 0===e&&(e="");var a=this,o=gapi.auth2.getAuthInstance();o.signIn().then(function(o){a._googleProfile=o.getBasicProfile(),a.getUserWithProvider("google",o.getId(),t,e)},function(e){t("Authentication failed.",e)})},Object.defineProperty(t.prototype,"facebookProfile",{get:function(){return this._fbProfile},enumerable:!0,configurable:!0}),t.prototype.loginWithFacebook=function(t,e){void 0===t&&(t=function(){}),void 0===e&&(e="");var a=this;FB.login(function(o){o.authResponse?(FB.api("/me","GET",{fields:"id,name,email,birthday"},function(t){a._fbProfile=t}),a.getUserWithProvider("facebook",FB.getAccessToken(),t,e)):t("User cancelled login or did not fully authorize.",null)},{scope:"email,user_birthday",return_scopes:!0})},t.prototype.getUserWithProvider=function(t,e,a,n){var r=this;void 0===a&&(a=function(){}),void 0===n&&(n="");var i=new FormData;i.append("Method",t),i.append("Token",e),n&&i.append("FacebookSenderId",n);var u={async:!0,crossDomain:!0,url:o.CustomerConfig.loginUrl,method:"POST",processData:!1,contentType:!1,mimeType:"multipart/form-data",data:i,success:function(t,n,i){var u=JSON.parse(i.responseText);200===u.StatusCode?(r.user=u.Data,r._token=u.Data.Token,r.authenticated=!0,$(r).trigger(s.CustomerEvents.AuthStateChange,r.authenticated),localStorage.setItem(o.CustomerConfig.authTokenStorage,u.Data.Token),a(null,u.Data)):(r.authenticated=!1,$(r).trigger(s.CustomerEvents.AuthStateChange,r.authenticated),a("User not signup",e))},error:function(t,o,n){JSON.parse(t.responseText),r.authenticated=!1,$(r).trigger(s.CustomerEvents.AuthStateChange,r.authenticated),a("User not signup",e)}};$.ajax(u)},t.prototype.logout=function(){FB.logout();var t=gapi.auth2.getAuthInstance();t.signOut(),localStorage.removeItem(o.CustomerConfig.authTokenStorage),this._token=null,this.user=null,this.authenticated=!1},t.prototype.signUp=function(t,e){var a=this;void 0===e&&(e=function(){});var n=new FormData;n.append("Phone",t.phone),n.append("Password",t.password),n.append("Fullname",t.fullName),n.append("Email",t.email),n.append("FacebookId",""),n.append("GoogleId",""),t.facebookSenderId&&n.append("FacebookSenderId",t.facebookSenderId);var r={async:!0,crossDomain:!0,url:o.CustomerConfig.signUpUrl,method:"POST",processData:!1,contentType:!1,mimeType:"multipart/form-data",data:n,success:function(t,n,r){console.error(r);var i=JSON.parse(r.responseText);200===i.StatusCode?(a.user=i.Data,a._token=i.Data.Token,a.authenticated=!0,$(a).trigger(s.CustomerEvents.AuthStateChange,a.authenticated),localStorage.setItem(o.CustomerConfig.authTokenStorage,i.Data.Token),e(null,i.Data)):(a.authenticated=!1,$(a).trigger(s.CustomerEvents.AuthStateChange,a.authenticated),e(i.StatusCode,i.StatusMessage))},error:function(t,o,n){var r=JSON.parse(t.responseText);a.authenticated=!1,$(a).trigger(s.CustomerEvents.AuthStateChange,a.authenticated),e(r.StatusCode,r.StatusMessage)}};$.ajax(r)},t.prototype.signUpWithProvider=function(t,e,a,n){var r=this;void 0===n&&(n=function(){});var i=new FormData;switch(i.append("Phone",a.phone),i.append("Password",""),i.append("Fullname",a.fullName),i.append("Email",a.email),a.facebookSenderId&&i.append("FacebookSenderId",a.facebookSenderId),t){case"facebook":i.append("FacebookId",FB.getUserID()),i.append("GoogleId","");break;case"google":i.append("FacebookId",""),i.append("GoogleId",e)}var u={async:!0,crossDomain:!0,url:o.CustomerConfig.signUpUrl,method:"POST",processData:!1,contentType:!1,mimeType:"multipart/form-data",data:i,success:function(t,e,a){var i=JSON.parse(a.responseText);200===i.StatusCode?(r.user=i.Data,r._token=i.Data.Token,r.authenticated=!0,$(r).trigger(s.CustomerEvents.AuthStateChange,r.authenticated),localStorage.setItem(o.CustomerConfig.authTokenStorage,i.Data.Token),n(null,i.Data)):(r.authenticated=!1,$(r).trigger(s.CustomerEvents.AuthStateChange,r.authenticated),n(i.StatusCode,i.StatusMessage))},error:function(t,e,a){var o=JSON.parse(t.responseText);r.authenticated=!1,$(r).trigger(s.CustomerEvents.AuthStateChange,r.authenticated),n(o.StatusCode,o.StatusMessage)}};$.ajax(u)},t.prototype.update=function(t,e){var a=this;void 0===e&&(e=function(){}),this.requiedAuthenticate(e)&&$.ajax({type:"POST",url:o.CustomerConfig.updateCustomerUrl,dataType:"json",data:t,headers:{token:this._token}}).done(function(t){200===t.StatusCode?($(a).trigger(s.CustomerEvents.CustomerEdited,t.Data),a.user=t.Data,e(null,t.Data)):e(t.StatusCode,t.StatusMessage)}).fail(function(t,a,o){e(a,o)})},t.getCards=function(){return this.cards=JSON.parse(localStorage.getItem(o.CustomerConfig.cardsStorage)),this.cards||(this.cards=[]),$(this).trigger(s.CustomerEvents.CardsChange,{data:this.cards}),this.cards},t.saveCards=function(){localStorage.setItem(o.CustomerConfig.cardsStorage,JSON.stringify(this.cards))},t.addToCard=function(t){var e=0,a=this.cards.filter(function(a,o){return a.Id==t.Id&&(e=o,!0)});a.length>0?this.cards[e].Quantity++:(t.Quantity=1,this.cards.push(t)),this.saveCards(),$(this).trigger(s.CustomerEvents.CardsChange,{data:this.cards})},t.removeCard=function(t){var e=0,a=this.cards.filter(function(a,o){return a.Id==t.Id&&(e=o,!0)});a.length>0&&(this.cards.splice(e,1),this.saveCards(),$(this).trigger(s.CustomerEvents.CardsChange,{data:this.cards}))},t.clearCard=function(){this.cards=[],this.saveCards(),$(this).trigger(s.CustomerEvents.CardsChange,{data:this.cards})},t.decreaseCard=function(t){var e=0,a=this.cards.filter(function(a,o){return a.Id==t.Id&&(e=o,!0)});a.length>0&&(1==this.cards[e].Quantity?this.cards.splice(e,1):this.cards[e].Quantity--,this.saveCards(),$(this).trigger(s.CustomerEvents.CardsChange,{data:this.cards}))},t.prototype.getBills=function(e){void 0===e&&(e=function(){}),this.requiedAuthenticate(e)&&$.ajax({type:"POST",url:o.CustomerConfig.getBillsUrl,dataType:"json",headers:{token:this._token}}).done(function(a){200===a.StatusCode?(a.Data.forEach(function(e){switch(e.Status){case"-1":e.Status=t.billStatus.DELETED;break;case"0":e.Status=t.billStatus.DELIVERING;break;case"1":e.Status=t.billStatus.WAITING;break;case"2":e.Status=t.billStatus.NOT_DELIVERING;break;case"4":e.Status=t.billStatus.PAYED;break;default:e.Status=t.billStatus.UNKNOW}}),e(null,a.Data)):e(a.StatusCode,a.StatusMessage)}).fail(function(t,a,o){e(a,o)})},t.prototype.getBillDetail=function(e,a){if(this.requiedAuthenticate(a)){var s=new FormData;s.append("BillId",e);var r={async:!0,crossDomain:!0,url:o.CustomerConfig.getBillUrl,method:"POST",headers:{Token:this._token},processData:!1,contentType:!1,mimeType:"multipart/form-data",data:s,success:function(e,o,s){var r=JSON.parse(s.responseText);if(200===r.StatusCode){switch(r.Data.Status){case"-1":r.Data.Status=t.billStatus.DELETED;break;case"0":r.Data.Status=t.billStatus.DELIVERING;break;case"1":r.Data.Status=t.billStatus.WAITING;break;case"2":r.Data.Status=t.billStatus.NOT_DELIVERING;break;case"4":r.Data.Status=t.billStatus.PAYED;break;default:r.Data.Status=t.billStatus.UNKNOW}r.Data.PromotionId?r.Data.Promotion="Có":r.Data.Promotion="Không Có",r.Data.BillDetails.forEach(function(t){t.ProductThumb=n.ServerConfig.host+n.ServerConfig.filesPath+t.ProductThumb}),a(null,r.Data)}else a(r.StatusCode,r.StatusMessage)},error:function(t,e,o){var n=JSON.parse(t.responseText);a(n.StatusCode,n.StatusMessage)}};$.ajax(r)}},t.prototype.sendBill=function(t,e){if(void 0===e&&(e=function(){}),this.requiedAuthenticate(e)){var a=new FormData;a.append("Latitude",t.latitude),a.append("Longitude",t.longitude),a.append("BillDetails",JSON.stringify(t.details)),a.append("PromotionCode",t.promotionCode),a.append("Address",t.address),a.append("Area",t.area),a.append("BranchId",t.branchId||1),console.log(this._token);var n={async:!0,crossDomain:!0,url:o.CustomerConfig.sendBillUrl,method:"POST",headers:{token:this._token},processData:!1,contentType:!1,mimeType:"multipart/form-data",data:a,success:function(t,a,o){var n=JSON.parse(o.responseText);200===n.StatusCode?e(null,n.Data):e(n.StatusCode,n.StatusMessage)},error:function(t,a,o){var n=JSON.parse(t.responseText);e(n.StatusCode,n.StatusMessage)}};$.ajax(n)}},t.prototype.getPromotions=function(t){if(this.requiedAuthenticate(t)){var e={async:!0,crossDomain:!0,url:o.CustomerConfig.getPromotionsUrl,method:"GET",headers:{token:this._token}};$.ajax(e).done(function(e){200===e.StatusCode?(e.Data.forEach(function(t){t.Photo=n.ServerConfig.host+n.ServerConfig.filesPath+t.Photo}),t(null,e.Data)):t(e.StatusCode,e.StatusMessage)}).fail(function(e,a,o){t(a,o)})}},t.getAllProducts=function(t){$.ajax({type:"GET",url:o.CustomerConfig.getAllProductsUrl,dataType:"json",crossDomain:!0}).done(function(e){200===e.StatusCode?(e.Data.forEach(function(t){t.Thumbnail=n.ServerConfig.host+n.ServerConfig.filesPath+t.Thumbnail}),t(null,e.Data)):t(e.StatusCode,e.StatusMessage)}).fail(function(e,a,o){t(a,o)})},t.getAllBlogs=function(t){var e={async:!0,crossDomain:!0,url:o.CustomerConfig.getBlogsUrl,method:"GET"};$.ajax(e).done(function(e){t(null,e)}).fail(function(e,a,o){t(a,o)})},t.events=s.CustomerEvents,t.billStatus=s.BillStatus,t.cards=[],t}();e.Customer=u},function(t,e,a){"use strict";var o=a(3),n=function(){function t(){}return t.getAllCategory=function(t){var e={async:!0,crossDomain:!0,url:o.EmployeeConfig.GetAllCategoryUrl,method:"GET",success:function(e,a,o){var n=JSON.parse(o.responseText);200===n.StatusCode?t(null,n.Data):t(n.StatusCode,n.StatusMessage)},error:function(e,a,o){var n=JSON.parse(e.responseText);t(n.StatusCode,n.StatusMessage)}};$.ajax(e)},t}();e.Employee=n},function(t,e,a){"use strict";var o=a(7),n=a(8);t.exports={Customer:o.Customer,Employee:n.Employee}}])});
//# sourceMappingURL=innoway.min.js.map